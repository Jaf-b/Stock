import{a as bt,b as Dt,c as St,d as Vt,e as vt,f as Mt,g as yt,h as Et,i as Ft,j as Pt,n as wt}from"./chunk-HJI4H7LB.js";import{a as lt,b as mt,c as st,d as dt,e as ut,f as ct,g as pt,h as ft,i as ht,j as gt,k as _t,l as Ct,m as xt,n as Tt,o as R,p as A,q as It,r as Qt}from"./chunk-Q3NTKMEE.js";import{a as W,b as y,d as X,e as Y,g as T,h as Z,i as tt,j as et,k as it,l as nt,m as ot,n as Q,q as U,r as k,s as L,t as N}from"./chunk-JXXXVDU4.js";import{l as Ut}from"./chunk-QKOWUZ2H.js";import{Ca as j,Da as q,Ea as $,Fa as a,Ga as o,Ha as C,Ia as h,Ja as g,L as z,La as F,O as J,Oa as x,Qa as H,T as E,Ua as V,Va as v,Wa as M,X as D,Xa as B,Y as S,Ya as l,Za as c,ab as P,ia as d,ja as _,kc as at,pb as K,pc as w,qc as rt,rc as I,ta as p,wa as f}from"./chunk-REGT5QFK.js";var O=(()=>{let i=class i{constructor(t){this.http=t,this.API_URL="http://localhost:3000/Vente"}GetDataFromList(){return this.http.get(this.API_URL)}AddToList(t){return console.log(t),this.http.post(this.API_URL,t)}DeleteToList(t){return console.log(t),this.http.delete(`${this.API_URL}/${t}`)}UpdtaToList(t,n){return this.http.put(`${this.API_URL}/${t}`,n)}};i.\u0275fac=function(n){return new(n||i)(J(K))},i.\u0275prov=z({token:i,factory:i.\u0275fac,providedIn:"root"});let e=i;return e})();var qt=["qte"],$t=["unitaire"];function Ht(e,i){if(e&1&&(a(0,"mat-option",8),l(1),o()),e&2){let s=i.$implicit;f("value",s.name),d(),c(s.name)}}function Bt(e,i){if(e&1&&(a(0,"mat-option",8),l(1),o()),e&2){let s=i.$implicit;f("value",s.Designation),d(),c(s.Designation)}}var G=(()=>{let i=class i{constructor(t,n,r,m){this._fb=t,this.Venteservice=n,this.data=r,this._Designation=m,this.Vendeur=[{name:"Jafred Bukulu"},{name:"Sharon Lusagila"},{name:"Moses Jazz"}],this.VenteForm=this._fb.group({date:new Date().toDateString(),Heure:new Date().toLocaleTimeString(),NameConsumer:new T("",y.required),Designation:new T("",y.required),Quantite:new T("",y.required),Prix_Unitaire:new T("",y.required),PrixTotal:new T})}OnClick(){if(this.VenteForm.valid)if(this.data){if(this.data.Designation!=this.VenteForm.get("Designation").getRawValue()){console.log("different");for(let t=0;t<this.designation.length;t++)if(this.designation[t].Designation==this.data.Designation){let n=this.designation[t].Quantite+this.data.Quantite,r=this.designation[t].Prix_Unitaire*n,m={Designation:this.designation[t].Designation,NameFournisseur:this.designation[t].NameFournisseur,PrixTotal:r,Prix_Unitaire:this.designation[t].Prix_Unitaire,Quantite:n,TypeDeVente:this.designation[t].TypeDeVente,date:this.designation[t].date};this._Designation.UpdtaToList(this.designation[t].id,m).subscribe(u=>{console.log(u)}),this.updateStockFinal()}}else for(let t=0;t<this.designation.length;t++)if(console.log(this.designation[t].id,"",this.designation[t].Designation),this.designation[t].Designation==this.data.Designation){let n=this.designation[t].Quantite+this.data.Quantite;n=n-this.VenteForm.get("Quantite").getRawValue();let r=this.designation[t].Prix_Unitaire,m=n*r,u={Designation:this.designation[t].Designation,NameFournisseur:this.designation[t].NameFournisseur,PrixTotal:m,Prix_Unitaire:r,Quantite:n,TypeDeVente:this.designation[t].TypeDeVente,date:this.designation[t].date};this._Designation.UpdtaToList(this.designation[t].id,u).subscribe(b=>{console.log(b)}),console.log(u)}this.prixTotal=+this.quantite.nativeElement.value*+this.unitaire.nativeElement.value,this.VenteForm.get("PrixTotal").setValue(this.prixTotal),this.Venteservice.UpdtaToList(this.data.id,this.VenteForm.value).subscribe(t=>{console.log(t)})}else{for(let t=0;t<this.designation.length;t++)if(console.log(this.designation[t].id,"",this.designation[t].Designation),this.designation[t].Designation==this.VenteForm.get("Designation").getRawValue()){let n=this.designation[t].Quantite-this.VenteForm.get("Quantite").getRawValue(),r=this.designation[t].Prix_Unitaire,m=n*r,u={Designation:this.designation[t].Designation,NameFournisseur:this.designation[t].NameFournisseur,PrixTotal:m,Prix_Unitaire:r,Quantite:n,TypeDeVente:this.designation[t].TypeDeVente,date:this.designation[t].date};this._Designation.UpdtaToList(this.designation[t].id,u).subscribe(b=>{console.log(b)})}this.prixTotal=+this.quantite.nativeElement.value*+this.unitaire.nativeElement.value,this.VenteForm.get("PrixTotal").setValue(this.prixTotal),this.Venteservice.AddToList(this.VenteForm.value).subscribe(t=>{console.log(t),location.reload()})}console.log("yes"),location.reload()}ngOnInit(){this.VenteForm.patchValue(this.data),this._Designation.GetDataFromList().subscribe(t=>{this.designation=t})}updateStockFinal(){for(let t=0;t<this.designation.length;t++)if(console.log(this.designation[t].id,"",this.designation[t].Designation),this.designation[t].Designation==this.VenteForm.get("Designation").getRawValue()){console.log(this.designation[t].Quantite),console.log("what the fuck");let n=this.designation[t].Quantite-this.VenteForm.get("Quantite").getRawValue(),r=this.designation[t].Prix_Unitaire,m=n*r,u={Designation:this.designation[t].Designation,NameFournisseur:this.designation[t].NameFournisseur,PrixTotal:m,Prix_Unitaire:r,Quantite:n,TypeDeVente:this.designation[t].TypeDeVente,date:this.designation[t].date};this._Designation.UpdtaToList(this.designation[t].id,u).subscribe(b=>{console.log(b)})}}};i.\u0275fac=function(n){return new(n||i)(_(nt),_(O),_(Vt),_(R))},i.\u0275cmp=E({type:i,selectors:[["app-sell-product"]],viewQuery:function(n,r){if(n&1&&(V(qt,5),V($t,5)),n&2){let m;v(m=M())&&(r.quantite=m.first),v(m=M())&&(r.unitaire=m.first)}},standalone:!0,features:[P],decls:39,vars:2,consts:[["qte",""],["unitaire",""],["mat-dialog-title","",1,"flex"],["mat-dialog-content",""],[3,"formGroup"],[1,"flex","p-t"],["appearance","outline"],["formControlName","NameConsumer"],[3,"value"],["formControlName","Designation"],[1,"flex"],["type","number","matInput","","formControlName","Quantite"],["type","number","matInput","","formControlName","Prix_Unitaire"],["type","number","matInput","",3,"value"],["mat-dialog-actions","",1,"flex"],["mat-raised-button","","mat-dialog-close","true"],["mat-raised-button","","color","primary","mat-dialog-close","true",3,"click"]],template:function(n,r){if(n&1){let m=F();a(0,"div",2)(1,"h1"),l(2,"Vendre un Produit"),o()(),a(3,"div",3)(4,"form",4)(5,"div",5)(6,"mat-form-field",6)(7,"mat-label"),l(8,"Nom du Vendeur"),o(),a(9,"mat-select",7),q(10,Ht,2,2,"mat-option",8,j),o()(),a(12,"mat-form-field",6)(13,"mat-label"),l(14,"Designation"),o(),a(15,"mat-select",9),q(16,Bt,2,2,"mat-option",8,j),o()()(),a(18,"div",10)(19,"mat-form-field",6)(20,"mat-label"),l(21,"Quantit\xE9"),o(),C(22,"input",11,0),o(),a(24,"mat-form-field",6)(25,"mat-label"),l(26,"Prix Unitaire"),o(),C(27,"input",12,1),o()(),a(29,"div",10)(30,"mat-form-field",6)(31,"mat-label"),l(32,"Prix Total"),o(),C(33,"input",13),o()()()(),a(34,"div",14)(35,"button",15),l(36,"Fermer"),o(),a(37,"button",16),x("click",function(){return D(m),S(r.OnClick())}),l(38,"Envoyer"),o()()}if(n&2){let m=B(23),u=B(28);d(4),f("formGroup",r.VenteForm),d(6),$(r.Vendeur),d(6),$(r.designation),d(17),f("value",+m.value*+u.value)}},dependencies:[k,U,Q,N,L,Dt,bt,at,St,I,w,Pt,Mt,yt,Ft,Et,ot,Z,W,tt,X,Y,et,it],styles:[".flex[_ngcontent-%COMP%]{display:flex;gap:1rem;justify-content:center}.flex[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1}.flex[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}.p[_ngcontent-%COMP%]{padding:1rem}.p-b[_ngcontent-%COMP%]{padding-bottom:1rem}.p-t[_ngcontent-%COMP%]{padding-top:1rem}"]});let e=i;return e})();function Gt(e,i){e&1&&(a(0,"th",19),l(1,"Date"),o())}function zt(e,i){if(e&1&&(a(0,"td",20),l(1),o()),e&2){let s=i.$implicit;d(),c(s.date)}}function Jt(e,i){e&1&&(a(0,"th",19),l(1,"Heure"),o())}function Kt(e,i){if(e&1&&(a(0,"td",20),l(1),o()),e&2){let s=i.$implicit;d(),c(s.Heure)}}function Wt(e,i){e&1&&(a(0,"th",19),l(1,"Nom du Vendeur"),o())}function Xt(e,i){if(e&1&&(a(0,"td",20),l(1),o()),e&2){let s=i.$implicit;d(),c(s.NameConsumer)}}function Yt(e,i){e&1&&(a(0,"th",19),l(1,"Designation"),o())}function Zt(e,i){if(e&1&&(a(0,"td",20),l(1),o()),e&2){let s=i.$implicit;d(),c(s.Designation)}}function te(e,i){e&1&&(a(0,"th",19),l(1,"Quantite"),o())}function ee(e,i){if(e&1&&(a(0,"td",20),l(1),o()),e&2){let s=i.$implicit;d(),c(s.Quantite)}}function ie(e,i){e&1&&(a(0,"th",19),l(1,"Prix Unitaire"),o())}function ne(e,i){if(e&1&&(a(0,"td",20),l(1),o()),e&2){let s=i.$implicit;d(),c(s.Prix_Unitaire)}}function oe(e,i){e&1&&(a(0,"th",19),l(1,"Prix Total"),o())}function ae(e,i){if(e&1&&(a(0,"td",20),l(1),o()),e&2){let s=i.$implicit;d(),c(s.PrixTotal)}}function re(e,i){e&1&&(a(0,"th",19),l(1,"ID"),o())}function le(e,i){if(e&1&&(a(0,"td",20),l(1),o()),e&2){let s=i.$implicit;d(),c(s.id)}}function me(e,i){e&1&&(a(0,"th",19),l(1,"Action"),o())}function se(e,i){if(e&1){let s=F();a(0,"td",20)(1,"button",21),x("click",function(){let n=D(s).$implicit,r=H();return S(r.Edit(n))}),a(2,"mat-icon"),l(3,"edit"),o()(),a(4,"button",21),x("click",function(){let n=D(s).$implicit,r=H();return S(r.Delete(n.id))}),a(5,"mat-icon"),l(6,"delete"),o()()()}}function de(e,i){e&1&&C(0,"tr",22)}function ue(e,i){e&1&&C(0,"tr",23)}var Le=(()=>{let i=class i{constructor(t,n,r){this.ServiceVente=t,this.dialog=n,this.final=r,this.title="Gestion des Ventes",this.admin=JSON.parse(localStorage.getItem("admin")),this.displayedColumns=this.isAdmin()}ngOnInit(){this.ServiceVente.GetDataFromList().subscribe(t=>{this.dataSource=new Ct(t),this.dataSource.sort=this.sort,console.log(t)}),this.final.GetDataFromList().subscribe(t=>{this.StockFinal=t})}Delete(t){this.ServiceVente.DeleteToList(t).subscribe(n=>{console.log(n);let r=wt(this.StockFinal,n);this.final.UpdtaToList(r.id,r).subscribe(m=>{console.log(m)})}),setTimeout("location.reload(true);",5e3)}Edit(t){this.dialog.open(G,{data:t})}open(){this.dialog.open(G)}ApplyFilter(t){let n=t.target.value;this.dataSource.filter=n.trim().toLocaleLowerCase(),console.log(n)}isAdmin(){let t;return this.admin?t=["id","date","Heure","NameConsumer","Designation","Quantite","Prix_Unitaire","PrixTotal","actions"]:t=["id","date","Heure","NameConsumer","Designation","Quantite","Prix_Unitaire","PrixTotal"],t}};i.\u0275fac=function(n){return new(n||i)(_(O),_(vt),_(R))},i.\u0275cmp=E({type:i,selectors:[["app-vente-table"]],viewQuery:function(n,r){if(n&1&&V(A,5),n&2){let m;v(m=M())&&(r.sort=m.first)}},standalone:!0,features:[P],decls:39,vars:4,consts:[[3,"title"],["mat-raised-button","",3,"click"],[1,"body"],[1,"container"],["type","text","matInput","",3,"keyup"],["mat-table","","matSort","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","date"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","Heure"],["matColumnDef","NameConsumer"],["matColumnDef","Designation"],["matColumnDef","Quantite"],["matColumnDef","Prix_Unitaire"],["matColumnDef","PrixTotal"],["matColumnDef","id"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-icon-button","",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(n,r){n&1&&(a(0,"app-admin-tool-bar",0)(1,"button",1),x("click",function(){return r.open()}),l(2,"Add Product"),o(),a(3,"div",2)(4,"div",3)(5,"mat-form-field")(6,"mat-label"),l(7,"Recherche"),o(),a(8,"input",4),x("keyup",function(u){return r.ApplyFilter(u)}),o()(),a(9,"table",5),h(10,6),p(11,Gt,2,0,"th",7)(12,zt,2,1,"td",8),g(),h(13,9),p(14,Jt,2,0,"th",7)(15,Kt,2,1,"td",8),g(),h(16,10),p(17,Wt,2,0,"th",7)(18,Xt,2,1,"td",8),g(),h(19,11),p(20,Yt,2,0,"th",7)(21,Zt,2,1,"td",8),g(),h(22,12),p(23,te,2,0,"th",7)(24,ee,2,1,"td",8),g(),h(25,13),p(26,ie,2,0,"th",7)(27,ne,2,1,"td",8),g(),h(28,14),p(29,oe,2,0,"th",7)(30,ae,2,1,"td",8),g(),h(31,15),p(32,re,2,0,"th",7)(33,le,2,1,"td",8),g(),h(34,16),p(35,me,2,0,"th",7)(36,se,7,0,"td",8),g(),p(37,de,1,0,"tr",17)(38,ue,1,0,"tr",18),o()()()()),n&2&&(f("title",r.title),d(9),f("dataSource",r.dataSource),d(28),f("matHeaderRowDef",r.displayedColumns),d(),f("matRowDefColumns",r.displayedColumns))},dependencies:[k,U,Q,N,L,_t,lt,st,pt,dt,mt,ft,ut,ct,ht,gt,Tt,xt,I,w,rt,Qt,A,It,Ut],styles:[".body[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100% justify-content:center;align-items:center;margin-top:50px}.container[_ngcontent-%COMP%]{width:90%}mat-form-field[_ngcontent-%COMP%]{width:100%}table[_ngcontent-%COMP%]{width:100%;z-index:-1}"]});let e=i;return e})();export{Le as default};
